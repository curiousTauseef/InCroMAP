\documentclass{bioinfo}

\usepackage[rightcaption]{sidecap} % Allows captions besides figures
%\usepackage{url} % Allows using the\url command (in NimbleGen citation)
%\usepackage{fixltx2e} % Can be used to force the order of images As-Is.

\copyrightyear{2012}
\pubyear{2012}

\begin{document}
\firstpage{1}

\title[Pathway-based visualization of cross-platform microarray datasets]{Pathway-based visualization of cross-platform microarray datasets}
\author[Clemens Wrzodek \textit{et~al}]{Clemens Wrzodek\,$^{1\footnote{to whom correspondence should be addressed}}$, Johannes Eichner\,$^{1}$ and Andreas Zell\,$^1$}

\address{$^{1}$Center for Bioinformatics Tuebingen (ZBIT), \\University of Tuebingen, 72076 T\"ubingen, Germany}
\history{Received on XXXXX; revised on XXXXX; accepted on XXXXX}

\editor{Associate Editor: XXXXXXX}

\maketitle

\begin{abstract}

\section{Motivation:}
% 1. Heute immer mehr ma platforms, und damit auch cross-p. datasets available
Today, a plethora of different microarray platforms is available. Still, mRNA microarrays are dominating but other platforms, like microRNA expression or DNA methylation, are becoming more and more popular. Therefore, also the amount of datasets, coming from the same biological samples but different microarray platforms is growing rapidly.

% 2. Keine gescheiten visualisierungsmethoden für alle datasets zusammen (insbesondere ohne direkten genbezug wie miRNA und DNAm)
There are only a few methods available to integratively analyze or visualize such heterogenous datasets. Most available methods are focused on single datasets or, in general, datasets that are directly referenced to protein coding genes (e.g., mRNA or protein). Especially methods that additionally visualize regulatory influences (e.g., by microRNAs) and epigenetic alterations (like DNA methylation) are extremely rare.

\section{Results:}
We present a novel pathway-based visualization method that is especially suitable for visualization of cross-platform microarray datasets. The proposed methodology can not only handle datasets with a direct reference to genes (i.e., mRNA or protein) but also microRNA expression and DNA methylation datasets. Furthermore, it is able to distinguish and separate different protein modifications and establish a regulatory context between the pathway and microRNAs. All four data types can be integratively visualized in the context of canonical pathways.

\section{Availability:}
The described method is implemented as part of the InCroMAP application that is freely available at \href{http://www.ra.cs.uni-tuebingen.de/software/InCroMAP/}{www.ra.cs.uni-tuebingen.de/software/InCroMAP}.
%\url{http://www.ra.cs.uni-tuebingen.de/software/InCroMAP/}.

\section{Contact:} \href{clemens.wrzodek@uni-tuebingen.de}{clemens.wrzodek@uni-tuebingen.de}
\end{abstract}




\section{Introduction}

The first generation of microarray platforms was developed as a high-throughput technique for
profiling the transcriptome of diverse biological systems (i.e., cells, organs or organisms) under
various experimental conditions \citep{Golub1999, Schena1995}. As these traditional gene-centered
arrays were mostly limited to mRNA transcripts, the vast majority of visualization tools is focused
on mRNA datasets (e.g., Expression Profiler -- \citealp{Kapushesky2004} or KegArray --
\citealp{KEGG}). To date, a plethora of different microarray platforms are readily available. These
include gene-centered platforms which rely on current genome annotations as well as unbiased tiling
arrays which interrogate large non-repetitive regions of the genome. Diverse types of platforms have
been specifically designed for the interrogation of different genomic features, ranging from mRNA or
miRNA transcripts, through proteins or protein modifications, to relevant functional elements such
as exons, SNPs or promoters \citep{Hoheisel2006}. In addition to arrays serving for the
quantification of global gene expression on the RNA or protein level, also epigenetic modifications
such as DNA methylation can be monitored on a genome-wide level using microarray technology
\citep{Schumacher2006}.

% Motivation fuer die Entwicklung des Tools
Several tools exist for the visual inspection of datasets from individual platforms \citep[see][for
some examples]{Gehlenborg2010}. However, the current inventory of publicly available tools that are
capable of integrating and jointly visualizing data from multiple microarray platforms, is still
very limited.  Here, we introduce a method for integrated pathway-centered visualization of
datasets, generated from the same biological samples using different microarray platforms, which
monitor complementary genomic and epigenomic features.

% Pathway-basierte Visualisierung vs. Regions-basierte Visualisierung
In contrast to commonly used region-based visualization methods (e.g., the UCSC genome browser --
\citealp{UCSCBrowser}), we propose to visualize the microarray data in the context of specific
signaling or metabolic pathways, which can in many cases be more easily related to the biological
problem under study, than individual genes or genomic regions.
%
% InCroMAP vs. publizierte Pathway-basierte Visualisierungstools
In recent years, diverse tools were developed, which are specialized in pathway analysis (e.g.,
Ingenuity) or pathway visualization (e.g., Cytoscape -- \citealp{Cytoscape} or KEGG Atlas --
\citealp{KEGGAtlas}). Some of these tools offer visualizing experimental data in a pathway (e.g.,
KegArray -- \citealp{KEGG}, GenMAPP -- \citealp{GenMAPP} or MGV -- \citealp{Symons2011}). For this
purpose, the experimental data is typically mapped to a color gradient and displayed in the
background color of the pathway nodes. GenMAPP or MGV even have capabilities to display multiple
colors in a single node (e.g., for the visualization of time-series experiments). MGV goes one step
further and offers additional features to put profile plots or heatmaps inside nodes. However, all
of these tools are not able to handle data from genomic features which have no direct reference to
the genes in a pathway (e.g., microRNAs or genomic regions). Furthermore, none of these tools offers
viable solutions that are tailored for the integration of multiple datasets obtained from
heterogeneous microarray platforms.

% Integrated oder single platform enrichment zur Identifikation der relevanten Pathways
% Ich denke, der kommende Abschnitt ist eher fuer App-Note oder Anwendungspaper...
% Suche auch nach "global map" fuer weitere zusammenhaengende auskommentierte teile

%The pathways, which are relevant for the conducted experiment, can be deduced from the differentially expressed
%genes using pathway enrichment analysis. For this purpose, candidate pathways which are putatively
%involved in the studied biological phenomenon are typically ranked according to \emph{p}-values resulting
%from a hypergeometric test for overrepresentation. The results are usually presented to the user as
%a sorted table or barplot which does not show any superordinate relations of the pathways detected
%as enriched with differentially expressed genes. In addition to this traditional approach, we also
%implemented an alternative method, which provides the user with a more structured view of the
%metabolic pathways linked to a certain microarray experiment. Owing to the hierarchical structure of
%the KEGG PATHWAY database, InCroMAP can visualize the enrichments computed for each individual
%metabolic pathway in the context of the higher-order overall metabolic pathway map compiled by KEGG
%(http://www.genome.jp/kegg/pathway/map/map01100.html). Starting from either a ranked pathway table
%or a colored meta-pathway map, individual pathways can be visualized in InCroMAP and overlaid with
%microarray data from multiple platforms, to facilitate thorough visual inspection of the measured
%pathway alterations. In contrast to previous work (TODO: Refs zu Cytoscape, Explain, etc.), InCroMAP
%offers convenient functions to overlay a pathway plot with sample-matched microarray data from
%platforms measuring gene regulation on mRNA, miRNA, DNAm and protein level.

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% MAPK different steps to visualization PICTURE
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure*}[t]
\centering
\includegraphics[width=1.0\textwidth]{figures/visualization-steps.png}
\caption{
These pictures show an excerpt of the KEGG "MAPK signaling" pathway. It is demonstrated how the
pathway and each of the four supported platforms are visualized in the pathway. Picture a) shows the
visualized KGML document as nodes and edges. b) demonstrates that the overall quality of KEGG
pathway visualizations can be improved by underlaying the original KEGG pathway picture. c) presents
the excerpt with visualized mRNA data, whereas red means upregulation, blue downregulation and
brighter colors represent smaller fold-changes. d) shows how protein modification datasets are
visualized in the pathway. Each of the boxes below "Egfr" represent different modifications of this
protein and the color of the box reflects the corresponding fold-change. e) illustrates DNA
methylation peaks in promoter regions. A bar from the middle of the black box to the left represents
hypomethylation and hypermethylation is expressed by a bar to the right. The size of the bar
determines the size of the maximum DNA methylation peak. f) demonstrates the visualization of
microRNA data by adding small triangles, representing microRNAs, and connecting them with grey edges
to their mRNA targets. The color of the microRNA nodes determines the corresponding fold-change.
}
\label{fig:visualization_steps}
\end{figure*}
%%%%%%%%%%%%%%%%%%%%%%%%%%%


%\begin{methods}
\section{Methods}

% Import von Microarray-Daten in InCroMAP
% (Refs zu Ringo, MEDME, AgiMicroRna, Limma, Annotate)
Before visualization, the microarray datasets of interest have to be preprocessed and annotated
using platform-specific workflows \citep{Limma, AgiMicroRna}. These workflows usually involve (1)
the quality control of the raw data \citep{arrayQualityMetrics}, (2) the data normalization to
correct for background noise and experimental variation \citep{Lim2007}, and (3) the mapping of
probes to genes or genomic regions. After these preprocessing steps the microarray data has to be
exported in tabular format. These tables have to contain two types of columns: (1) annotation
columns, containing probe or probeset IDs (e.g., Affymetrix IDs) and database IDs of the
corresponding genes (e.g., Ensembl or Entrez IDs), and (2) data columns containing either
fold-changes and/or \emph{p}-values resulting from basic statistical analysis of the microarray
data.

% JE: Habe das mal rausgenommen, da es zu InCroMAP-spezifisch ist oder ?
% For convenience, these tables can be imported into InCroMAP per drag-and-drop, and the
% tool tries to auto-detect the platform type.

% Import von Pathways in InCroMAP
The pathway data is automatically imported from KEGG \citep{KEGG}. In the KEGG PATHWAY database, each pathway map
is available for download as KGML document, which is internally converted into a graph structure
by InCroMAP. In order to overcome limitations of the KGML format, one can create an overlay
graph that shows the original KEGG pathway image in the background, which may provide the user with
additional information about cellular structure and compartmentalization.
%The graph structures, including the overlay pictures, are interactively visualized by InCroMAP using the yWorks graph viewer (TODO: Ref.).
%
% Visualisierung von Microarray-Daten im Kontext von Pathways
After importing the data, the KEGG pathway nodes, which correspond to genes or gene families, can be
overlaid with fold-changes measured on mRNA or protein expression level. Furthermore, DNA
methylation changes observed in the proximal promoter regions can be visualized. In the final step,
additional nodes corresponding to miRNAs can be added to the pathway and colored according to the
expression changes measured in the underlying experiment. See Figure~\ref{fig:visualization_steps}
for an illustration of all the above-mentioned visualization steps.


%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CELL CYCLE PICTURE
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{SCfigure*}[1][tb]
\centering
\includegraphics[width=.70\textwidth]{figures/mmu04110.png}
\caption{Integrated visualization of datasets from four different platforms in the KEGG "Cell Cycle" pathway.
The colors reflect the fold-changes, whereas red means upregulated and blue means
downregulated. White corresponds to a fold-change of zero and darker colors represent stronger
differential expression. The color of each node itself reflects the mRNA fold-change, e.g., "Ttk"
shows a strong upregulation and Smc3 is downregulated. Smaller boxes below nodes show the protein
and protein modification expression. For example, we visualized three different forms of "Trp53": a
phosphorylation at the Serine 15 (S15) site, which shows almost no expression change, a modification
of the S9 site, which is upregulated and the basic protein itself, which is also upregulated.  The
black boxes left of the nodes represent the maximum DNA methylation fold-change peak. A bar to the
left represents hypomethylation and a bar to the right hypermethylation. In out example, "Ttk" shows
a strong hypermethylation. MicroRNAs are added as small triangles to the pathway and connected with
a grey edge to their mRNA targets. The color of the microRNA nodes reflects the fold-change, as
described for the mRNA nodes.}
\label{fig:cellcycle}
\end{SCfigure*}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Pathway visualization}

The basic prerequisite for generating a pathway-based visualization is visualizing the pathway
itself. For this purpose, we are using KEGGtranslator \citep[see][]{Wrzodek2011}, which performs a
basic conversion of the KEGG KGML documents to GraphML. In short, KEGGtranslator converts all KGML entries to nodes
and all relations to edges. Some basic errors are corrected automatically and appropriate shapes,
colors and labels are inferred. Then, all nodes are annotated with diverse identifiers (e.g., Entrez Gene
identifiers -- \citealp{EntrezGene}),
descriptions, and further information. The resulting document provides the basis for the
subsequently generated visualizations.

% JE: Die Bedeutung von den KEGG-Knoten (einzelne Gene oder Genfamilien) habe ich weiter oben eingebaut.
% Ich wÃ¼rde daher den folgenden Absatz streichen um den Leser nicht zu ausfÃ¼hrlich mit Details vollzulabern ;-)
%
% At this point, it is important to note that KEGG usually draws referenced
% pathways as rectangular nodes with rounded corners, small molecules as circles, and single gene
% products (e.g., enzymes) as well as gene families as rectangles. This means that one rectangular
% node can consist of multiple different enzymes, depending on the KEGG definition.

% Vorteile des Pathway-Bilds im Hintergrund
At least for some pathways, the KGML document available at KEGG does not contain all information
that is depicted in the corresponding pathway map. Thus, an overlay graph can be generated which contains the
original pathway map as a static transparent image in the background of the interactive graph plot
(see Figure~\ref{fig:visualization_steps}b). Owing to this feature, additional information on
cellular structure (e.g., schematic drawings of receptors involved in cell signaling) can be maintained.


% CW: Bezieht sich auf KEGG metabolic pathways und ist deshalb auskommentiert
% This feature also enhances the visualization of the global maps in KEGG PATHWAY, as additional information on
% the organisation of subordinate pathway groups is provided by the pathway image.


\subsection{Visualization of messenger RNA expression data}

% Darstellung von mRNA Daten
As mRNA expression data is typically available for the whole genome and thus, also for the majority
of nodes in a particular KEGG pathway, these data are displayed in the background color of the
nodes.
%
% Eingabeformat fÃ¼r mRNA Daten
As input, our method requires preprocessed mRNA datasets with annotation columns (e.g.,
gene identifiers) and data columns, which are referred to as \emph{observations}. In this context,
observations can be any statistical significance (e.g., \emph{p}-values) or comparative measure
(e.g., fold-changes or log-ratios).

% Mapping von mRNA Daten auf Pathway-Knoten
Next, these data have to be broken down to a single value for each pathway node, which then
determines the color of the node. As single nodes can represent multiple genes in KEGG, the
intensities measured by probes, corresponding to the same node, have to be summarized. To this end,
the mean or median is calculated across probes, which were mapped to the same node, or the probe
with the strongest or most significant signal (i.e., $\min\emph{p}-value$ or $\max|fold-change|$) is
decisive for coloring the node.

% EinfÃ¤rbung der Knoten
To visualize fold-changes or log-ratios in the context of pathways, a color gradient ranging from
blue through white to red is used to illustrate down- and upregulation,
respectively. Non-differentially expressed genes are shown in white, and pathway nodes for which no
mRNA data is available are displayed in grey. If desired, \emph{p}-values can be shown instead of
fold-changes. For this purpose, we propose to map the negative logarithm of the \emph{p}-values to a
color gradient, which leads to a more intuitive illustration of the observed significances.  See
Figure~\ref{fig:visualization_steps}c) for an example of visualized mRNA data.

% JE: WÃ¼rde den Absatz streichen, da er zu viele technische Details enthÃ¤lt
% For fold-changes (which are usually $log_2$ values), we color every node with a fold-change $\geq2$ red
% and all fold-changes $\leq-2$ blue. Fold-changes of zero are defined to have a white color and
% colors between $\pm2$ are faded from blue or red to white, depending on the actual fold-change. The
% same procedure can be used for \emph{p}-values, except that just one minimum threshold and one
% minimum color must be defined. Furthermore, the color for \emph{p}-values should not be changed on a
% linear, but on a log-scale.


\subsection{Visualization of protein expression data}

% Darstellung von Protein-Daten
Visualization of protein datasets is performed by adding small boxes below pathway nodes and
changing the color of the boxes according to the corresponding protein expression data. As state-of-the-art
experimental techniques (e.g., reverse-phase protein arrays, quantitative mass spectrometry)
facilitate the distinction between different protein modifications (e.g., phosphorylated or
acetylated forms of proteins), multiple measurements may correspond to the same gene \citep{Pirnia2009, Yates2009}.
In this particular case, the expression change observed for each individual protein form is represented
as a separate box below the corresponding node. Each of these boxes is then labeled according to the
respective protein form and colored based on the underlying expression data, as described previously
for mRNA datasets. We require protein datasets to be annotated with database identifiers referring
to proteins or genes (e.g., Entrez Gene IDs), which allows us to perform a straightforward mapping to
pathway nodes. For protein modification dataset, we further require a column, determining the
actual modification for every protein.


\subsection{Visualization of DNA methylation data}

% Darstellung von DNAm Daten
The DNA methylation (DNAm) status, observed in the proximal promoter of a gene, is graphically
represented by adding boxes to the left side of the pathway nodes. These boxes are drawn on a white
background and contain a black bar which stretches from the middle to the left, in the case of hypomethylation and from the middle to the right, to indicate hypermethylation. Instead of discriminating between hyper- and hypomethylation, one can simply visualize the amount of differential methylation. In this case, the black bar would stretch from the left border of the box to the right border.

% Berechnung des DNAm Gesamtwerts
The length of the black bar is proportional to a summary value reflecting the DNAm status of the
promoter of a certain gene.  This value is by default computed from the probes in a region ranging
from -2000 bps upstream of the transcription start site to 500 bps downstream. Normally, the
value of the maximum peak found in the promoter of a gene is visualized. For peak detection,
Nimblegen proposed two algorithms which are called "Windowed Threshold Detection" and
"Second Derivative Peak Detection". A detailed description of these methods can be found in the
user's guide of Nimblegen's SignalMap software \citep[see][]{NimblegenSignalMapUserGuide}.
In addition to those sophisticated peak detection methods, one can also approximate peaks by
using simple methods like picking the probe with maximum differential methylation (i.e., $\max|fold-change|$).
As an alternative to visualizing peaks derived from the probe-level fold-changes one can also use a statistical
approach to estimate the differential methylation in a promoter region. For this purpose, we
propose to divide the promoter region $r$ into segments $b_1,\dots,b_n$, each containing a fixed number of probes.
For each segment a statistical test (e.g., ordinary or moderated t-test) can be employed to detect
differential methylation between two experimental groups. An overall significance value $s$ can then be computed
from the \emph{p}-values $p(b_1),\dots,p(b_n)$ using the formula $s=\frac{1}{n}\sum\limits_{i=1}^n-\log(p(b_i))$.
This binning approach has the advantage of being sensitive to local changes in DNA methylation, as promoter segments with
significant changes in DNA methylation are highly weighted. Conversely, segments for which slight changes were observed only
contribute marginally to the overall significance score.

% Darstellung der DNAm Einzelwerte
The purpose of this visualization technique is giving researchers a hint if,
and how many methylation changes are present in a gene promoter.
For more details, the genomic location of individual peaks can be visualized in a DNAm profile plot
(see Figure~\ref{fig:methdetails}). To this end, the fold-changes observed for the probes
covering the promoter region of a certain gene are plotted along their genomic coordinates. This
depiction is particularly useful for comparing the DNAm profiles and peaks found for different
observations (i.e., sample groups).

% Eingabeformat fï¿½r DNAm Daten
In order to relate the DNAm data to data from gene-centered microarrays (e.g., mRNA expression
arrays), each probe needs to be mapped to a gene. Thus, we require annotation columns containing the
chromosome and the genomic position of each probe to facilitate the mapping from probes to genes.

%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Methylation Details Picture
%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[tb]
\centering
% Add a border
\setlength\fboxsep{1pt}
\setlength\fboxrule{1pt}
\fbox{
  \includegraphics[width=.47\textwidth]{figures/meth-details.png}
}
\caption{Integrated visualization of the "MAPK signaling" pathway with a detailed view of DNA methylation in the proximal promoter of "Egfr".
The DNA methylation bar next to the "Egfr" gene in the pathway plot indicates hypermethylation. A profile plot of this genes genomic location
reveals an increase in DNA methylation in this genes promoter.}
\label{fig:methdetails}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Visualization of microRNA expression data}

% Mapping von miRNA Daten auf Pathways
Visualizing microRNA (miRNA) datasets in the context of KEGG pathways is not straightforward, as
these pathways do not contain miRNAs \emph{a priori}. Therefore, in order to incorporate the data into a
pathway, a connection must be established between the miRNAs and the protein-coding genes
in the pathway. As the common mechanism of miRNAs involves the binding to complementary mRNA
transcripts \citep{Bartel2004}, we propose to link miRNAs to their known target mRNAs. These target
mRNAs can be obtained from diverse databases, which either contain experimentally verified targets
(e.g., miRecords -- \citealp{miRecords}, miRTarBase -- \citealp{miRTarBase}, TarBase --
\citealp{TarBase}) or predicted miRNA targets \citep[reviewed in][]{Alexiou2009}.
We used a union of the three mentioned experimentally verified miRNA target databases for the
figures in this publication.


% Darstellung von miRNA Daten
Based on a map containing all connections between miRNAs and their target mRNAs, the miRNAs
monitored in a specific experiment can be added to a pathway of interest as small triangular nodes,
which have outgoing edges to the pathway nodes corresponding to their target mRNAs. The triangular
miRNA nodes are colored according to their expression, as described previously for mRNA datasets.
This leads to an integrated visualization of a pathway, overlaid with miRNA and mRNA expression
data, and extended with putative miRNA-mRNA interactions. Figure~\ref{fig:visualization_steps}f)
shows an example result of the described procedure.

%\end{methods}

\section{Results and discussion}

In this work, we present a novel methodology for the combined visualization of DNA methylation data,
as well as mRNA, (phospho-) protein, and miRNA expression data in the context of canonical pathways.
This methodology involves strategies for mapping the data from heterogeneous platform types to a common
functional element, namely a gene, embedded into a pathway which regulates higher-order cellular
functions or processes. Furthermore, we propose visualization techniques which are particularly suited for
displaying quantitative data from diverse genomic features in an integrated graph plot,
which represents a metabolic or signaling pathway of interest. However, generating a joint visualization of
epigenomics, transcriptomics and proteomics data is challenging, as each data type has
its own characteristics.

% Zusammenfassung: Proteomics-Daten
For proteomics data, we propose to map basic and modified proteins to their common source gene and
draw each protein form as a separate box below the pathway node representing the source gene. Using this kind of
visualization one can, for instance, determine the activation state of a protein by comparing the color (i.e., expression state)
of the box corresponding to the basic form with the one which corresponds to the phosphorylated form.

% Zusammenfassung: Transcriptomics-Daten (mRNA (kurz), miRNA)
In brief, for most mRNA expression datasets it is sufficient to annotate the probesets with appropriate
gene identifiers, in order to link the data with the pathways of interest. For miRNA datasets this linkage
is complicated by the fact that miRNAs are normally not contained in pathways.
% miRNA discussion
A simple approach for putting miRNAs in context would be, inspecting the gene locus of the microRNAs. This approach already led to some valuable results, e.g., the detection of a strong co-regulation within the genomic DLK1 locus \citep{DLK1miRNA}. But this approach is not suitable for linking the miRNAs with genes in a pathway. Firstly, genes from neighboring loci are not generally co-regulated. Secondly, a pathway shows, for example, how a signal is processed within a certain organism. The genes in a pathway are usually functionally related or present regulatory relationships. Hence, when adding new nodes to a pathway, the relation should also be made based on functional or regulatory relationships. MicroRNAs are known to have a regulatory function by binding to complementary mRNA transcripts \citep{Bartel2004}. These interactions are documented in public databases, which we use to extract interactions between miRNAs and their target mRNAs. Using this information, one can add the miRNAs to the pathways and connect them to the existing nodes by inserting edges to the corresponding targets.

% Zusammenfassung: Epigenomics-Daten
The probe design of DNA methylation microarrays is typically not gene-centered, but
region-based. Thus, in contrast to gene-centered arrays, the probes are not organized in
probesets which were designed specifically for the same gene. Instead, these arrays
cover specific genomic regions of interest, for instance gene promoters. The connection to protein
coding genes is usually established by defining a region around the transcription start site (TSS)
of a gene and assigning all probes in this region to the gene.
%
% Problematik bei Berechnung eines Gesamtwerts fÃ¼r DNAm
But visualizing the signal levels of all probes assigned to a certain gene in one pathway node would
clutter the picture and reduce the clarity of it.
Thus, we concluded that it is most important to know if there are methylation changes in a promoter and maybe also if the gene
is rather hyper- or hypomethylated. The methylation details can then be inspected manually later
(e.g., the InCroMAP application provides a detailed XY plot of the DNA methylation if one clicks on a pathway node).
Therefore, a method for the computation of a single summary value for DNA methylation probes is needed. For mRNA expression arrays, the summarization of probes corresponding to
the same transcript is usually achieved by the median polishing algorithm \citep[see][]{GCRMA} which
effectively alleviates the influence of outlier probes. However, this algorithm is only applicable under the assumption
that ideally the probe intensities are evenly distributed along transcripts.
As a matter of fact, this assumption does not hold for the DNA methylation of promoter regions, as the probe intensities are
firstly not expected to be evenly distributed along the region. Secondly, outlier probes, corresponding to
DNA methylation peaks, are mostly not due to probe-specific effects, but rather reflect a local change
in the DNA methylation pattern, which may be biologically meaningful. Thus, one of the summarization methods we
consider advisable is the detection and visualization of maximum peaks as it is sensitive to local changes in DNA methylation.

Alternatively, if the data is properly normalized and smoothed (i.e. probe-level specific effects are alleviated), one can also take the probe with maximum differential methylation to approximate the peak.
Nevertheless, every summarization method has its limitations. The maximum peak methods are definitely
less robust against probe-specific effects and the results may be inconclusive as a single positive peak may
suggest hypermethylation of a region, while the majority of the promoter is clearly hypomethylated.
On the other hand, a mean fold-change summarization clearly suffers from the fact that localized differential methylation
is averaged out. Means or medians of DNA methylation probes in a promoter region are typically close to zero.


% Auskommentiert da das Ende quasi besagt, dass unsere Methode schlecht ist!
%Despite these limitations, in principle, we deem both methods suited for indicating
%differential methylation in the promoters of most genes. However, due to the heterogeneity and complexity of DNAm patterns,
%plotting the probe-level DNAm data along genomic coordinates often leads to more reliable conclusions about the DNAm state of promoters.

% JE: Habe den Abschnitt neu geschrieben
% For example, with this procedure one can define that all probes within -2000 and +500 bps of a TSS
% are most important for the regulation of this gene's expression.  But then, it is not recommended to
% visualize all this information in the pathway. For example, it would be possible to create small XY
% plots of the promoter region for every gene and add these pictures as small icons below each
% node. But this would clutter the picture and destroy the clarity of it. Thus, we concluded that it
% is most important to know if there are methylation changes in a promoter and maybe also if the gene
% is rather hyper- or hypomethylated. The methylation details can then be inspected manually later
% (e.g., the InCroMAP application provides a detailed XY plot of the DNA methylation if one clicks on
% a pathway node). But the most important information in the first place is, if there are methylation
% changes at all. And this can be expressed with various summarization methods and a small black bar
% that grows with the amount of significant methylation changes in a gene promoter.

% Beispiel fÃ¼r Visualisierung aller Plattform-Typen in einem Pathway
An example for a KEGG pathway with visualized mRNA, miRNA, protein and DNA methylation data can be
seen in Figure~\ref{fig:cellcycle}. The visualization of multiple heterogenous datatypes can not be
performed with either a loss of information or a loss of clarity. Since these integrated pathway
visualizations should provide an overview, rather than a detailed listing of all possible
information, we tried to keep the clarity and summarize information wherever possible.

At first glance, it always seems to be desirable putting as much information as possible into the pathway. For example, it would be possible to create small XY plots of promoter regions for every gene and add these pictures as small icons below each node. Other possibilities include the creation of Heatmaps or visualization of multiple timepoints with various colors in a single node.
But, especially if multiple datasets are visualized together in a pathway, it is very important to summarize things and not overload the whole picture. The main purpose of a pathway-based visualization is not to replace all other analysis and visualization methods, but rather giving a general overview that helps researchers further analyzing their data.



\section{Conclusion}

Pathway enrichment analysis is a common microarray data analysis tool to discover pathways, whose
genes show significant expression changes. In most applications, these enrichments are endpoints in
analysis workflows. There are some methods or applications that can show pictures of significantly
altered pathways and a few applications can even change node shapes or colors according to a single
expression dataset. However, not only the amount of available microarray datasets is growing
rapidly, but also the number of available platforms. At present, microarray platforms exist for
profiling diverse genomic features, as for instance mRNAs, miRNAs, proteins and promoter regions.
However, the current repertoire of analysis and especially visualization methods which are specifically designed for
the analysis of cross-platform datasets is still very limited.

Here, we present a pathway-based cross-platform microarray visualization method which
can for instance be used to inspect relevant pathways detected by pathway enrichment analyses. Especially the
visualization of DNA methylation and miRNA datasets is a feature that can not be found in other
visualization approaches. By integratively visualizing all datatypes, it helps researchers to
discover potential relationships across multiple layers of gene regulation.
% JE: SchÃ¶nes Beispiel. Habe noch die DNAm vor die miRNA gesetzt um alle Plattformen in der Kausalkette unterzubringen.
% CE: Gut gemacht, nur leider zeigt InCroMAP bei miRNAs keine DNA methylattion an...
For example, the hypomethylation of a promoter may cause the upregulation of a miRNA which may in turn
downregulate the corresponding target mRNA, whereupon a connected pathway protein could change its expression or activation state.
Such complex cascades of effects, which involve multiple levels of gene regulation can be deduced from the pathway images
generated by the here presented visualization method.

% Alter Text!
%For example, a miRNA can be upregulated and
%the corresponding mRNA target downregulated, whereupon a connected pathway protein could also be
%downregulated in protein expression. This effect, which involves information about pathway relations
%and miRNA targets, as well as miRNA, mRNA and protein expression, would be directly visible from the
%here presented visualization method.

% TODO:
%- Zusammenfassung, vor allem Einzigartigkeit der Methode (insb. miRNA, (DNAm)) herausstellen,
%- und kurze interpretation eines finalen bildes liefern ("man sieht in einem bild
% pathway informationen, miRNA relationen, expressionsdaten von miRNA, mRNA, bla; und sonst ist
% meist nach dem enrichment schluss bzw mRNA einfarbung bereits das maximum moegliche").

\section*{Acknowledgement}
We gratefully acknowledge contributions from Andreas Dr\"ager and Finja B\"uchel, as well as the
whole MACRCAR consortium.

\paragraph{Funding\textcolon}
The research leading to these results has received funding from the Innovative Medicine Initiative
Joint Undertaking (IMI JU) under grant agreement nr. 115001 (MARCAR project).

\bibliographystyle{natbib}
%\bibliographystyle{achemnat}
%\bibliographystyle{plainnat}
%\bibliographystyle{abbrv}
%\bibliographystyle{bioinformatics}
%\bibliographystyle{plain}

\bibliography{document}
%TODO: When paper is ready, comment \bibliography line and add content of document.bbl here.

\end{document}
